---
import { createHighlighter } from "shiki";
import k8sCode from "../constants/k8s.txt?raw";

const highlighter = await createHighlighter({
  themes: ["github-light", "synthwave-84"],
  langs: ["go"],
});

const lightHtml = highlighter.codeToHtml(k8sCode, {
  lang: "go",
  theme: "github-light",
});

const darkHtml = highlighter.codeToHtml(k8sCode, {
  lang: "go",
  theme: "synthwave-84",
});
---

<div
  class="absolute inset-0 z-0 overflow-hidden pointer-events-none select-none"
>
  <!-- Light Mode Code -->
  <div
    class="absolute inset-0 opacity-30 dark:hidden whitespace-pre font-mono text-xs leading-tight"
    set:html={lightHtml}
  />

  <!-- Dark Mode Code -->
  <div
    class="absolute inset-0 hidden dark:block opacity-30 whitespace-pre font-mono text-xs leading-tight mix-blend-screen"
    set:html={darkHtml}
  />

  <!-- Overlay to fade out edges/ensure readability -->
  <div
    class="absolute inset-0 bg-gradient-to-b from-white/80 via-transparent to-white/80 dark:from-gray-900/80 dark:via-transparent dark:to-gray-900/80"
  >
  </div>
</div>

<style is:global>
  /* Ensure shiki output fits and doesn't break layout */
  .shiki {
    background-color: transparent !important;
    margin: 0;
    padding: 1rem;
    width: 100%;
    height: 100%;
  }
</style>
