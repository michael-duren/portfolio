---
import { Image } from "astro:assets";
import Technologies from "./Technologies.astro";
import meJem from "../images/me-jem.jpeg";
import mePresenting from "../images/me-presenting.jpeg";
import mePrime from "../images/me-prime.jpeg";
import meThat from "../images/me-that.jpeg";
import meTodd from "../images/me-todd.jpeg";

const images = [mePresenting, mePrime, meJem, meTodd, meThat];
---

<section
    id="about"
    class="py-24 px-4 w-full max-w-7xl mx-auto relative scroll-mt-16"
>
    <div class="flex flex-col lg:flex-row gap-16 items-center">
        <!-- Text Content -->
        <div
            class="flex-1 space-y-8 animate-on-scroll opacity-0 translate-y-10 transition-all duration-700"
        >
            <div class="space-y-2">
                <h2
                    class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-blue-500 pb-2"
                >
                    About Me
                </h2>
                <div class="h-1 w-20 bg-purple-600 rounded-full"></div>
            </div>

            <div
                class="prose dark:prose-invert max-w-none text-lg leading-relaxed text-gray-700 dark:text-gray-300"
            >
                <p>
                    I'm a software engineer with 3+ years building production
                    systems in
                    <span
                        class="font-semibold text-purple-600 dark:text-purple-400"
                        >C#/.NET</span
                    >,
                    <span class="font-semibold text-cyan-600 dark:text-cyan-400"
                        >Go</span
                    > and
                    <span class="font-semibold text-blue-600 dark:text-blue-400"
                        >TypeScript</span
                    >.
                </p>

                <p>
                    Early in my career, a mentor had me write out what every
                    single line of code was doing. That practice changed
                    everything. When you force yourself to see the code as the
                    machine sees it, bugs become obvious and solutions emerge
                    naturally.
                </p>

                <p>
                    I've built <a
                        href="https://www.patterninterruptinc.com/"
                        target="_blank"
                        class="text-purple-600 dark:text-purple-400 font-semibold hover:underline decoration-2 underline-offset-2"
                        >Next Step CMS</a
                    >, a SaaS platform managing chemical dependency treatment. I
                    also maintain a home monitoring stack and contribute to open
                    source projects.
                </p>

                <p>
                    I'm drawn to the problems that live between services: how
                    systems communicate, fail, recover, and scale.
                </p>
            </div>

            <div class="pt-4">
                <h3
                    class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100"
                >
                    Technologies
                </h3>
                <Technologies />
            </div>
        </div>

        <!-- Image Grid -->
        <div class="flex-1 w-full flex justify-center relative animate-on-scroll opacity-0 translate-y-10 transition-all duration-700 delay-300">
             <div class="relative w-full flex flex-wrap justify-center content-center gap-4 p-4 lg:p-8">
                {
                    images.map((img, index) => (
                        <div
                            class={`relative transition-all duration-500 hover:scale-110 hover:z-50 cursor-pointer group`}
                            style={`
                                transform: rotate(${Math.random() * 10 - 5}deg);
                                margin-left: ${index % 2 === 0 ? '-20px' : '0'};
                                margin-top: ${index > 1 ? '-30px' : '0'};
                                z-index: ${index};
                            `}
                        >
                            <div class="bg-white p-3 pb-12 shadow-lg hover:shadow-2xl transition-shadow duration-300 w-40 md:w-48 transform rotate-1">
                                <Image
                                    src={img}
                                    alt={`Michael Duren photo ${index + 1}`}
                                    class="w-full aspect-[4/5] object-cover filter sepia-[0.2] contrast-105 group-hover:sepia-0 transition-all duration-500 bg-gray-100"
                                />
                                <!-- Tape/Pin effect -->
                                <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-8 rounded-full bg-gray-300 border-2 border-gray-400 shadow-inner z-10 flex items-center justify-center">
                                    <div class="w-2 h-2 rounded-full bg-gray-400 opacity-50"></div>
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</section>

<script>
    const observer = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    entry.target.classList.remove(
                        "opacity-0",
                        "translate-y-10",
                    );
                    observer.unobserve(entry.target);
                }
            });
        },
        {
            threshold: 0.1,
        },
    );

    document.querySelectorAll(".animate-on-scroll").forEach((el) => {
        observer.observe(el);
    });
</script>
