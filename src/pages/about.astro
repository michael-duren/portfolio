---
import { Image } from "astro:assets";
import MainLayout from "../layouts/MainLayout.astro";
import rubberDuck from "../images/duck.png";
import rubberDuckBlue from "../images/duck-blue.png";
import pen from "../images/pen.svg";
import Technologies from "../components/Technologies.astro";
import AnimatedBackground from "../components/AnimatedBackground.astro";
---

<MainLayout title="Michael Duren - About">
  <AnimatedBackground />
  <div class="relative z-10">
    <!-- Desk surface -->
    <div class="desk-surface"></div>
    <div
      class="flex flex-col xl:flex-row xl:justify-between xl:w-full relative"
    >
      <div
        class="flex flex-col gap-2 xl:gap-3 2xl:gap-4 flex-1 order-1 card card-bordered shadow-md dark:shadow-gray-500"
      >
        <div class="card-body">
          <h2
            class="font-bold text-2xl xl:text-4xl text-gray-900 dark:text-gray-100 card-title"
          >
            About Me
          </h2>
          <div class="card-normal">
            <p class="font-bold text-purple-700 dark:text-purple-400">
              What's with the rubber <span
                class="text-amber-700 dark:text-amber-400">duck?</span
              >
            </p>
            <p class="text-xs text-gray-600 dark:text-gray-400">
              (Try clicking them!)
            </p>
          </div>
          <p class="xl:text-base text-sm text-gray-900 dark:text-gray-100">
            The rubber <span class="font-semibold">duck</span> represents a debugging
            philosophy: explain your problem out loud, line by line, until the answer
            reveals itself.
          </p>
          <p class="xl:text-base text-sm text-gray-900 dark:text-gray-100">
            Early in my career, a mentor had me write out what every single line
            of code was doing—not what I thought it did, but what it actually
            executed. That practice changed everything. When you force yourself
            to see the code as the machine sees it, bugs become obvious and
            solutions emerge naturally.
          </p>
          <p class="font-bold text-purple-700 dark:text-purple-400">
            Anyway...
          </p>
          <p
            class="font-semibold text-gray-600 dark:text-gray-300 xl:text-base text-sm"
          >
            I'm a software engineer with 3+ years building production systems in
            C#/.NET and TypeScript. After years of feature development, I'm
            transitioning toward infrastructure and distributed systems work—the
            layer that makes applications reliable, observable, and scalable.
          </p>
          <p class="xl:text-base text-sm text-gray-900 dark:text-gray-100">
            I've built <a
              href="/work"
              class="text-purple-700 dark:text-purple-400 hover:underline"
              >Next Step CMS</a
            > with <a
              href=""
              class="text-purple-700 dark:text-purple-400 hover:underline"
              >Pattern Interrupt</a
            >, a SaaS platform serving 1,200+ users managing chemical dependency
            treatment. I maintain a home monitoring stack with Grafana,
            Prometheus, and node exporters across multiple VMs. I contribute to
            open source projects like Code for Recovery, learning systems
            programming and infrastructure tooling in Go.
          </p>
          <p class="xl:text-base text-sm text-gray-900 dark:text-gray-100">
            I'm drawn to the problems that live between services: how systems
            communicate, fail, recover, and scale. I want to work on the
            platforms and infrastructure that make great applications possible.
          </p>
        </div>
      </div>

      <!-- Interactive ducks section with mousepad -->
      <div
        class="flex-1 flex-col flex justify-center items-center relative order-2"
      >
        <!-- Mousepad -->
        <div class="mousepad">
          <div class="mousepad-surface">
            <div
              class="duck-container xl:flex-col flex-row gap-4 xl:gap-8 h-full"
            >
              <div class="desk-item active:scale-95">
                <Image
                  id="rubber-duck"
                  class="floating-duck cursor-pointer"
                  src={rubberDuck}
                  alt="Rubber Duck"
                  draggable="false"
                />
                <div class="item-shadow"></div>
              </div>
              <div class="desk-item active:scale-90">
                <Image
                  id="pen"
                  class="floating-duck cursor-pointer"
                  src={pen}
                  alt="Pen"
                  draggable="false"
                />
                <div class="item-shadow pen-shadow"></div>
              </div>
              <div class="desk-item active:scale-90">
                <Image
                  id="rubber-duck-blue"
                  class="floating-duck cursor-pointer"
                  src={rubberDuckBlue}
                  alt="Blue Rubber Duck"
                  draggable="false"
                />
                <div class="item-shadow"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="w-full mt-4">
      <h2 class="font-bold text-2xl mb-4 text-gray-900 dark:text-gray-100">
        Technologies I use:
      </h2>
      <Technologies />
    </div>
  </div>

  <audio preload="auto" id="squeek-high" src="/audio/squeek-high.mp3"></audio>
  <audio preload="auto" id="squeek-low" src="/audio/squeek-low.mp3"></audio>
</MainLayout>

<style>
  /* Desk surface effect */
  .desk-surface {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 60%;
    background: linear-gradient(
      180deg,
      transparent 0%,
      rgba(139, 92, 46, 0.1) 30%,
      rgba(139, 92, 46, 0.15) 100%
    );
    pointer-events: none;
    z-index: -1;
  }

  .dark .desk-surface {
    background: linear-gradient(
      180deg,
      transparent 0%,
      rgba(61, 45, 28, 0.2) 30%,
      rgba(61, 45, 28, 0.3) 100%
    );
  }

  .desk-content {
    /* background: rgba(255, 255, 255, 0.85); */
    backdrop-filter: blur(10px);
    padding: 2rem;
    border-radius: 1rem;
    box-shadow:
      0 10px 30px rgba(0, 0, 0, 0.1),
      0 1px 8px rgba(0, 0, 0, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .dark .desk-content {
    background: rgba(15, 23, 42, 0.85);
    box-shadow:
      0 10px 30px rgba(0, 0, 0, 0.6),
      0 1px 8px rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(71, 85, 105, 0.3);
  }

  /* Mousepad */
  .mousepad {
    position: relative;
    padding: 2rem;
    margin: 2rem;
    perspective: 1000px;
  }

  .mousepad-surface {
    position: relative;
    background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
    padding: 2rem 3rem;
    border-radius: 1rem;
    box-shadow:
      0 15px 35px rgba(0, 0, 0, 0.3),
      inset 0 -2px 8px rgba(0, 0, 0, 0.4),
      inset 0 2px 8px rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.1);
    transform: rotateX(5deg);
  }

  .dark .mousepad-surface {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
    border: 2px solid rgba(255, 255, 255, 0.05);
  }

  .mousepad-surface::before {
    content: "";
    position: absolute;
    top: 0.5rem;
    left: 0.5rem;
    right: 0.5rem;
    bottom: 0.5rem;
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 0.75rem;
    pointer-events: none;
  }

  /* Duck animations */
  .duck-container {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    height: 100%;
    padding: 1rem;
  }

  .desk-item {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .floating-duck {
    position: relative;
    animation: gentle-float 3s ease-in-out infinite;
    transition: transform 0.2s ease;
    max-width: 150px;
    user-select: none;
    filter: drop-shadow(0 8px 12px rgba(0, 0, 0, 0.3));
    z-index: 2;
  }

  .dark .floating-duck {
    filter: drop-shadow(0 8px 12px rgba(0, 0, 0, 0.6));
  }

  .floating-duck:hover {
    transform: scale(1.1) rotate(5deg);
  }

  .floating-duck:active {
    transform: scale(0.95);
  }

  /* Item shadows on mousepad */
  .item-shadow {
    position: absolute;
    bottom: -15px;
    width: 80%;
    height: 20px;
    background: radial-gradient(
      ellipse at center,
      rgba(0, 0, 0, 0.4) 0%,
      transparent 70%
    );
    border-radius: 50%;
    z-index: 1;
    animation: shadow-float 3s ease-in-out infinite;
  }

  .pen-shadow {
    width: 60%;
    transform: rotate(-45deg);
  }

  #rubber-duck {
    animation-delay: 0s;
  }

  #pen {
    animation-delay: 0.75s;
    max-width: 120px;
  }

  #rubber-duck-blue {
    animation-delay: 1.5s;
  }

  @keyframes gentle-float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-15px);
    }
  }

  @keyframes shadow-float {
    0%,
    100% {
      opacity: 0.4;
      transform: scale(1);
    }
    50% {
      opacity: 0.2;
      transform: scale(0.8);
    }
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .desk-content {
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .mousepad {
      padding: 1rem;
      margin: 0 auto;
      margin-top: 2rem;
      width: 100%;
      max-width: 400px;
    }

    .mousepad-surface {
      padding: 1.5rem 2rem;
    }

    .floating-duck {
      max-width: 80px;
    }

    #pen {
      max-width: 60px;
    }

    .duck-container {
      flex-direction: row !important;
      justify-content: space-around;
      padding: 0.5rem;
    }
  }

  @media (max-width: 480px) {
    .floating-duck {
      max-width: 60px;
    }

    #pen {
      max-width: 45px;
    }

    .mousepad-surface {
      padding: 1rem 1.5rem;
    }
  }
</style>

<script>
  import { sound } from "../store/store";

  document.addEventListener("astro:page-load", () => {
    const ducks = document.querySelectorAll(".floating-duck");
    const squeekHigh = document.getElementById(
      "squeek-high",
    ) as HTMLAudioElement;
    const squeekLow = document.getElementById("squeek-low") as HTMLAudioElement;

    ducks.forEach((duck) => {
      duck.addEventListener("click", () => {
        // Only play sound if sound is enabled
        if (sound.get()) {
          if (Math.random() > 0.5) {
            squeekHigh?.play();
          } else {
            squeekLow?.play();
          }
        }
      });
    });
  });
</script>
