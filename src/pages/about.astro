---
import { Image } from "astro:assets";
import MainLayout from "../layouts/MainLayout.astro";
import rubberDuck from "../images/duck.png";
import rubberDuckBlue from "../images/duck-blue.png";
import pen from "../images/pen.svg";
import Technologies from "../components/Technologies.astro";
import AnimatedBackground from "../components/AnimatedBackground.astro";
---

<MainLayout title="Michael Duren - About">
  <AnimatedBackground />
  <div class="relative z-10">
    <div class="flex lg:justify-between lg:w-full">
      <div class="flex flex-col gap-2 md:gap-3 lg:gap-4 flex-1">
        <h2 class="font-bold text-2xl md:text-4xl text-gray-900 dark:text-gray-100">About Me</h2>
        <div>
          <p class="font-bold text-purple-700 dark:text-purple-400">
            What's with the rubber <span class="text-amber-700 dark:text-amber-400">duck?</span>
          </p>
          <p class="text-xs text-gray-600 dark:text-gray-400">(Try clicking them!)</p>
        </div>
        <p class="md:text-base text-sm text-gray-900 dark:text-gray-100">
          The rubber <span class="font-semibold">duck</span> represents a debugging
          philosophy: explain your problem out loud, line by line, until the answer
          reveals itself.
        </p>
        <p class="md:text-base text-sm text-gray-900 dark:text-gray-100">
          Early in my career, a mentor had me write out what every single line
          of code was doing—not what I thought it did, but what it actually
          executed. That practice changed everything. When you force yourself to
          see the code as the machine sees it, bugs become obvious and solutions
          emerge naturally.
        </p>
        <p class="font-bold text-purple-700 dark:text-purple-400">Anyway...</p>
        <p class="font-semibold text-gray-600 dark:text-gray-300 md:text-base text-sm">
          I'm a software engineer with 3+ years building production systems in
          C#/.NET and TypeScript. After years of feature development, I'm
          transitioning toward infrastructure and distributed systems work—the
          layer that makes applications reliable, observable, and scalable.
        </p>
        <p class="md:text-base text-sm text-gray-900 dark:text-gray-100">
          I've built <a href="/work" class="text-purple-700 dark:text-purple-400 hover:underline"
            >Next Step CMS</a
          > with <a href="" class="text-purple-700 dark:text-purple-400 hover:underline"
            >Pattern Interrupt</a
          >, a SaaS platform serving 1,200+ users managing chemical dependency
          treatment. I maintain a home monitoring stack with Grafana,
          Prometheus, and node exporters across multiple VMs. I contribute to
          open source projects like Code for Recovery, learning systems
          programming and infrastructure tooling in Go.
        </p>
        <p class="md:text-base text-sm text-gray-900 dark:text-gray-100">
          I'm drawn to the problems that live between services: how systems
          communicate, fail, recover, and scale. I want to work on the platforms
          and infrastructure that make great applications possible.
        </p>
      </div>

      <!-- Interactive ducks section -->
      <div class="flex-1 flex-col flex justify-around relative">
        <div class="duck-container flex-col md:flex-row gap-4 md:gap-0 h-full">
          <div class="active:scale-95">
            <Image
              id="rubber-duck"
              class="floating-duck cursor-pointer"
              src={rubberDuck}
              alt="Rubber Duck"
              draggable="false"
            />
          </div>
          <div class="active:scale-90">
            <Image
              id="pen"
              class="floating-duck cursor-pointer"
              src={pen}
              alt="Pen"
              draggable="false"
            />
          </div>
          <div class="active:scale-90">
            <Image
              id="rubber-duck-blue"
              class="floating-duck cursor-pointer"
              src={rubberDuckBlue}
              alt="Blue Rubber Duck"
              draggable="false"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="w-full mt-4">
      <h2 class="font-bold text-2xl mb-4 text-gray-900 dark:text-gray-100">Technologies I use:</h2>
      <Technologies />
    </div>
  </div>

  <audio preload="auto" id="squeek-high" src="/audio/squeek-high.mp3"></audio>
  <audio preload="auto" id="squeek-low" src="/audio/squeek-low.mp3"></audio>
</MainLayout>

<style>
  /* Duck animations */
  .duck-container {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    height: 100%;
  }

  .duck-container > div:nth-child(1) {
    align-self: flex-start;
    margin-top: 2rem;
  }

  .duck-container > div:nth-child(2) {
    align-self: center;
  }

  .duck-container > div:nth-child(3) {
    align-self: flex-end;
    margin-bottom: 2rem;
  }

  .floating-duck {
    position: relative;
    animation: gentle-float 3s ease-in-out infinite;
    transition: transform 0.2s ease;
    max-width: 200px;
    user-select: none;
  }

  .floating-duck:hover {
    transform: scale(1.1) rotate(5deg);
  }

  .floating-duck:active {
    transform: scale(0.95);
  }

  #rubber-duck {
    animation-delay: 0s;
  }

  #pen {
    animation-delay: 0.75s;
  }

  #rubber-duck-blue {
    animation-delay: 1.5s;
  }

  @keyframes gentle-float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-20px);
    }
  }
</style>

<script>
  import { sound } from "../store/store";

  document.addEventListener("astro:page-load", () => {
    const ducks = document.querySelectorAll(".floating-duck");
    const squeekHigh = document.getElementById(
      "squeek-high",
    ) as HTMLAudioElement;
    const squeekLow = document.getElementById("squeek-low") as HTMLAudioElement;

    ducks.forEach((duck) => {
      duck.addEventListener("click", () => {
        // Only play sound if sound is enabled
        if (sound.get()) {
          if (Math.random() > 0.5) {
            squeekHigh?.play();
          } else {
            squeekLow?.play();
          }
        }
      });
    });
  });
</script>
